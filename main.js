(()=>{"use strict";let e={body:document.querySelector("body"),libraryContainer:document.querySelector(".library-container"),inputField:document.getElementById("libro"),searchBtn:document.querySelector("button"),form:document.querySelector("form"),logo:document.querySelector(".logo"),container:document.querySelector(".container-for-description-element"),image:document.querySelector(".background-image"),getImage(){e.image=document.querySelector(".background-image")}};const t=e;class n{static displayBooks=function(e){if(n.clearPage(),"error"===e||0===e.length){let e=document.createElement("div");t.libraryContainer.append(e);let n=document.createElement("h3");n.classList.add("alert"),n.textContent="No book matches";let o=document.createElement("h5");return o.classList.add("suggestion"),o.textContent="Please try looking for another category",e.append(n),void n.after(o)}for(let n=0;n<e.length;n++){let o=document.createElement("div");o.classList.add("book-container"),o.setAttribute("data-book",e[n].key),t.libraryContainer.append(o);let a=document.createElement("h3");a.textContent=e[n].title,o.append(a);let r=e[n].authors.length;r>8&&(r=8);for(let t=0;t<r;t++){let r=document.createElement("h5");if(r.textContent=e[n].authors[t].name,a.after(r),7==t){let e=document.createElement("h5");e.textContent="...",o.append(e);break}}}};static displayDescription=function(e){let n=document.createElement("div");n.classList.add("cover");let o=document.createElement("div");o.classList.add("book-description-container");let a=document.createElement("h3");a.textContent="Description";let r=document.createElement("p");if(e.length<=1300)r.textContent=e;else{const t=e.substring(0,1300);r.innerHTML=t+'...<a target="_blank" class="Open-library-link" href="https://openlibrary.org/">(read more on Open Library).</a>'}t.container.prepend(n),t.body.classList.add("block"),n.before(o),o.append(a),a.after(r)};static resetDescription=function(e){e.target.classList.contains("cover")&&(t.container.innerHTML='<img class="background-image remove-image" src="./img/background-image.svg">',t.body.classList.remove("block"))};static loading=function(){let e=document.createElement("h5");e.textContent="Loading...",e.classList.add("suggestion"),t.libraryContainer.append(e)};static clearPage=function(){t.libraryContainer.innerHTML=""};static removeImage=function(){t.image.classList.add("remove-image")};static addImage=function(){t.getImage(),t.image.setAttribute("class","background-image")}}class o{static getList=async function(e){return fetch(e).then((e=>e.ok?e.json():Promise.reject())).then((e=>e.works)).catch((()=>"error"))};static getDescription=async function(e){return fetch(e).then((e=>e.json())).then((e=>"object"==typeof e.description||null==e.description?"Description is not available for this book":e.description))}}(()=>{function e(){n.removeImage(),n.clearPage(),n.loading();let e=t.inputField.value;e=e.toLowerCase(),e=e.replace(/\s/g,""),o.getList(`https://openlibrary.org/subjects/${e}.json`).then((e=>{n.displayBooks(e)})),t.inputField.value=null}t.libraryContainer.addEventListener("click",(function(e){if(e.target.classList.contains("book-container")){let t=e.target.dataset.book;o.getDescription(`https://openlibrary.org${t}.json`).then((e=>{n.displayDescription(e)}))}else{if(null==e.target||e.target.classList.contains("library-container")||e.target.classList.contains("alert")||e.target.classList.contains("suggestion"))return;{let t=e.target.parentNode.dataset.book;o.getDescription(`https://openlibrary.org${t}.json`).then((e=>{n.displayDescription(e)}))}}})),t.searchBtn.addEventListener("click",e),document.onkeydown=function(n){""!=t.inputField.value&&"Enter"===n.key&&e()},t.form.addEventListener("submit",(e=>{e.preventDefault()})),t.logo.addEventListener("click",(()=>{n.clearPage(),n.addImage()})),document.addEventListener("click",(e=>{n.resetDescription(e)}))})()})();